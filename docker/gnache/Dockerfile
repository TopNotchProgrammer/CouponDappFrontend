FROM node:12-alpine

WORKDIR /app

RUN npm install -g ganache-cli
RUN npm install -g truffle
RUN apk add --no-cache git
RUN git clone https://github.com/topnotchprogrammer-com/CouponDappBackend
COPY ./truffle-config.js ./CouponDappBackend/truffle-config.js
COPY ./1_initial_migration.js ./CouponDappBackend/migrations/1_initial_migration.js
COPY ./startup.sh ./CouponDappBackend/startup.sh

EXPOSE 8545
CMD ["ganache-cli",\
    "-h",\
    "0.0.0.0", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000001,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000002,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000003,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000004,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000005,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000006,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000007,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000008,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000009,1000000000000000000000\"", \
    "--account=\"0x0000000000000000000000000000000000000000000000000000000000000010,1000000000000000000000\""]
